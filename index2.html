---
layout: article
title: Московский клуб программистов
excerpt: Тяжела и неказиста жизнь простого программиста
---

<p>Как выяснилось, в Москве есть большая потребность в неформальных встречах программистов,
без привязки к конкретным технологиям и языкам.</p>

<p>Ниша «посидеть и поговорить» оказалась незаполненной.
Этот пробел требует немедленной ликвидации, которой мы и занимаемся.</p>

<p><a href="/blog/">Блог клуба программистов</a>.</p>

<div id="posts">
</div>

<script>
window.addEventListener('load', function() {
	var uris = [
		'http://markshevchenko.pro/feed.xml',
		'https://xenidev.github.io/feed.xml'
	];

	var responseCount = 0;
	var posts = [];

	for (var i = 0; i < uris.length; i++) {
		var request = new XMLHttpRequest();

		request.open('GET', uris[i], true);
		request.onload = function(data) {
			if (data.target.status >= 200 && data.target.status < 300) {
				var feed = data.target.responseXML;
				var entries = feed.querySelectorAll('entry');
				for (var i = 0; i < entries.length; i++) {
					var post = parsePost(entries[i]);
					posts.push(post);
				}
			}

			if (++responseCount == uris.length) {
				posts.sort(function(a, b) {
					return b.published.getTime() - a.published.getTime();
				});

				appendPosts(posts);
			}
		};

		request.send();
	}

	function parsePost(entry) {
		return {
			title: getAttribute(entry, 'link', 'title'),
			href: getAttribute(entry, 'link', 'href'),
			published: new Date(getTextContent(entry, 'published')),
			author: getTextContent(entry, 'author > name'),
			summary: getTextContent(entry, 'summary'),
			image: getAttribute(entry, 'thumbnail', 'url')
		};
	}

	function getAttribute(entry, selector, attributeName) {
		var element = entry.querySelector(selector);

		return (element == null) ? null : element.getAttribute(attributeName);
	}

	function getTextContent(entry, selector) {
		var element = entry.querySelector(selector);

		return (element == null) ? null : element.textContent;
	}

	function appendPosts(posts) {
		var parent = document.getElementById('posts');

		for (var i = 0; i < posts.length; i++)
			appendPost(parent, posts[i]);
	}

	function appendPost(parent, post) {
		var div = document.createElement('div');
		div.setAttribute('class', 'post');
		appendHeaderLink(div, post.title, post.href);
		
		appendParagraph(div, post.published, 'post-date');
		appendParagraph(div, post.author, 'post-author');
		appendImage(div, post.image, 'post-image');
		appendParagraph(div, post.summary);

		parent.appendChild(div);
	}

	function appendHeaderLink(parent, title, href) {
		var a = document.createElement('a');
		a.setAttribute('href', href);
		a.appendChild(document.createTextNode(title));
		
		var h2 = document.createElement('h2');
		h2.appendChild(a);

		parent.appendChild(h2);
	}

	function appendParagraph(parent, text, className) {
		if (text == null)
			return;

		var p = document.createElement('p');
		p.setAttribute('class', className);
		p.appendChild(document.createTextNode(text));

		parent.appendChild(p);
	}

	function appendImage(parent, src, className) {
		if (src == null)
			return;

		var img = document.createElement('img');
		img.setAttribute('src', src);
		img.setAttribute('class', className);

		parent.appendChild(img);
	}
});
</script>
